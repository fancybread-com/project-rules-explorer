---
description: Security best practices for VS Code extensions
globs: ["**/*.ts", "**/*.js", "package.json"]
alwaysApply: true
---

# VS Code Extension Security

## Input Validation

- Validate all user inputs before processing
- Sanitize file paths to prevent directory traversal
- Check file extensions and MIME types
- Validate JSON and YAML content before parsing
- Use allowlists instead of blocklists for validation

## File System Security

- Never execute user-provided code directly
- Validate file paths against workspace boundaries
- Check file permissions before operations
- Avoid writing to system directories
- Use secure temporary file creation

## Network Security

- Validate URLs before making requests
- Use HTTPS for all external communications
- Implement proper timeout handling
- Sanitize data received from external sources
- Avoid storing sensitive data in plain text

## Extension Manifest Security

- Minimize required permissions in package.json
- Use specific activation events
- Avoid unnecessary workspace access
- Review and audit all dependencies
- Keep dependencies up to date

## Data Protection

- Encrypt sensitive data at rest
- Use secure storage APIs when available
- Implement proper session management
- Clear sensitive data from memory
- Follow data retention policies